#!/bin/bash

brew install tmux
brew install ack
brew install reattach-to-user-namespace
brew install python
brew install wget
brew install leiningen
pip install https://github.com/Lokaltog/powerline/tarball/develop


cp fonts/Inconsolata-dz\ for\ Powerline.otf ~/Library/Fonts

# Cannot change iTerm2 settins while it is running
# https://code.google.com/p/iterm2/issues/detail?id=1872
if launchctl list | grep com.googlecode.iterm2; then
  echo "Changes to iTerm2 preferences will be overwritten when iTerm2 is closed."
  echo "Close iTerm2 and rerun this script from the standard terminal"
  open /Applications/Utilities/Terminal.app
  exit 1
fi

cp pristine/com.googlecode.iterm2.plist ~/Library/Preferences/.
# OS X 10.9 caches settings until logout, force it to reload
defaults read com.googlecode.iterm2 > /dev/null

# TODO: Could use PlistBuddy to be more explicit about which settings get changed
# /usr/libexec/PlistBuddy -c "Set :\"New Bookmarks\":0:\"Non Ascii Font\" InconsolataForPowerline-dz 12" ~/Library/Preferences/com.googlecode.iterm2.plist >/dev/null
# /usr/libexec/PlistBuddy -c "Set :\"New Bookmarks\":0:\"Normal Font\" InconsolataForPowerline-dz 12" ~/Library/Preferences/com.googlecode.iterm2.plist >/dev/null

rm ~/.lein/profiles.clj
ln -s `pwd`/profiles.clj ~/.lein/profiles.clj

rm ~/.lein/user.clj
ln -s `pwd`/user.clj ~/.lein/user.clj

rm ~/.tmux.conf
ln -s `pwd`/.tmux.conf ~/.tmux.conf

ln -s `pwd`/ ~/.emacs.d

ln -s `pwd`/.ackrc ~/.ackrc

if [ ! -f `pwd`/user.init.el ];
then
    cp `pwd`/pristine/user.init.el.default `pwd`/user.init.el
fi

git submodule init
git submodule update

vendor/gitutils/submodule-hooks/install.sh `pwd`
